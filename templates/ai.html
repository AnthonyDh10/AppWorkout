{% extends "base.html" %}

{% block title %}Coach IA - AI Fitness Coach{% endblock %}

{% block content %}
<div class="fade-in">
    <h1>ü§ñ Coach IA</h1>
    
    <div class="card">
        <h2>Cr√©ez votre programme personnalis√©</h2>
        <div class="card" style="padding: var(--spacing-md);">
            <ul style="list-style: none; padding: 0;">
                <li style="margin-bottom: var(--spacing-sm); color: var(--text-secondary);">
                    <span style="color: var(--accent);">‚Ä¢</span> Soyez pr√©cis dans vos objectifs
                </li>
                <li style="margin-bottom: var(--spacing-sm); color: var(--text-secondary);">
                    <span style="color: var(--accent);">‚Ä¢</span> Indiquez vos contraintes (temps, mat√©riel disponible)
                </li>
                <li style="margin-bottom: 0; color: var(--text-secondary);">
                    <span style="color: var(--accent);">‚Ä¢</span> N'h√©sitez pas √† demander des variantes ou alternatives
                </li>
            </ul>
        </div>        
        <form method="post" id="aiForm">
            <label for="prompt">D√©crivez vos objectifs :</label>
            <textarea 
                id="prompt" 
                name="prompt" 
                placeholder="Ex: Hypertrophie, 4 s√©ances par semaine, Full body, nouveau cycle"
                required
            ></textarea>
            <button type="submit" class="btn btn-primary btn-full" id="submitBtn">
                üöÄ G√©n√©rer mon programme
            </button>
        </form>
    </div>

    <!-- Indicateur de chargement -->
    <div class="card loading-container" id="loadingIndicator" style="display: none;">
        <div class="loading-content">
            <div class="ai-loader">
                <div class="loader-circle"></div>
                <div class="loader-circle"></div>
                <div class="loader-circle"></div>
            </div>
            <h3 style="color: var(--accent); margin-top: var(--spacing-lg); margin-bottom: var(--spacing-sm);">
                üß† Analyse de votre demande...
            </h3>
            <p style="color: var(--text-secondary); text-align: center; margin: 0;">
                L'IA g√©n√®re votre programme personnalis√©
            </p>
        </div>
    </div>

    {% if training_program_html %}
    <div class="card fade-in" id="programResult">
        <h2>üìã Votre Programme d'Entra√Ænement</h2>
        <div class="training-program-content">
            {{ training_program_html|safe }}
        </div>
    </div>
    {% endif %}
    
</div>

<style>
.loading-container {
    text-align: center;
    padding: var(--spacing-xxl) var(--spacing-lg);
}

.loading-content {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
}

.ai-loader {
    display: flex;
    gap: var(--spacing-sm);
    margin: var(--spacing-lg) 0;
}

.loader-circle {
    width: 16px;
    height: 16px;
    border-radius: 50%;
    background: linear-gradient(45deg, var(--accent), var(--accent-secondary));
    animation: bounce 1.4s infinite ease-in-out both;
}

.loader-circle:nth-child(1) {
    animation-delay: -0.32s;
}

.loader-circle:nth-child(2) {
    animation-delay: -0.16s;
}

@keyframes bounce {
    0%, 80%, 100% {
        transform: scale(0);
        opacity: 0.5;
    }
    40% {
        transform: scale(1);
        opacity: 1;
    }
}

.loading-container h3 {
    animation: pulse-text 2s infinite;
}

@keyframes pulse-text {
    0%, 100% {
        opacity: 1;
    }
    50% {
        opacity: 0.6;
    }
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('aiForm');
    const loadingIndicator = document.getElementById('loadingIndicator');
    const submitBtn = document.getElementById('submitBtn');
    const originalBtnText = submitBtn.innerHTML;

    form.addEventListener('submit', function(e) {
        // Afficher l'indicateur de chargement
        loadingIndicator.style.display = 'block';
        
        // Modifier le bouton
        submitBtn.disabled = true;
        submitBtn.innerHTML = '‚è≥ G√©n√©ration en cours...';
        submitBtn.style.opacity = '0.6';
        submitBtn.style.cursor = 'not-allowed';

        // Scroll vers l'indicateur de chargement
        setTimeout(() => {
            loadingIndicator.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }, 100);
    });
});
</script>
{% endblock %}